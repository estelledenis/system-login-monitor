import csv

def parse_windows_logs(log_path):
    failed_logins = []
    successful_logins = []

    try:
        with open(log_path, mode='r', encoding='utf-8') as file:
            reader = csv.DictReader(file)
            for row in reader:
                event_id = row['Event ID']
                print(event_id)
                timestamp = row['Date and Time']
                print(timestamp)
                category = row['Task Category']
                print(category)

                # Parse login events
                if event_id == '4624':  # Successful login
                    successful_logins.append((timestamp, category))
                elif event_id == '4625':  # Failed login
                    failed_logins.append((timestamp, category))
    except Exception as e:
        print(f"Error reading log file: {e}")
        return

    # Display results
    print("Successful Logins:")
    for login in successful_logins:
        print(f"Timestamp: {login[0]}\nCategory:\n{login[1]}\n")

    print("\nFailed Logins:")
    if not failed_logins:
        print("No failed logins")
    else:
        for login in failed_logins:
            print(f"Timestamp: {login[0]}\nCategory:\n{login[1]}\n")


# Test the script
log_path = "C:\\Users\\estel\\Downloads\\event_logs.csv"
parse_windows_logs(log_path)

